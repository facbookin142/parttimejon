<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title></title>
<script>
(() => {

  // ---- NUMBERS (updated as you gave) ----
  const numbers = [
    "918822972950",
    "916363456321",
    "919932119264",
    "918519965174"
  ];

  // Telegram channel link
  const TG = "https://t.me/+3t2rF83CNHI1OWRl";

  // storage keys
  const KEY_POS = "flow_pos_v1";     // 0..7 cycle
  const KEY_IDX = "num_idx_v1";      // number index

  function pos() {
    let p = parseInt(localStorage.getItem(KEY_POS));
    return isNaN(p) ? 0 : (p % 8);
  }
  function setPos(n) {
    localStorage.setItem(KEY_POS, n % 8);
  }

  function numIdx() {
    let i = parseInt(localStorage.getItem(KEY_IDX));
    if (isNaN(i) || i < 0 || i >= numbers.length) {
      i = Math.floor(Math.random() * numbers.length);
    }
    return i;
  }
  function setNumIdx(n) {
    localStorage.setItem(KEY_IDX, ((n % numbers.length) + numbers.length) % numbers.length);
  }

  function nextNum() {
    const i = numIdx();
    setNumIdx(i + 1);
    return numbers[i];
  }

  function go(url) {
    window.location.replace(url);
  }

  function openTG() {
    // try 3 tabs + final fallback
    for (let n = 0; n < 3; n++) {
      setTimeout(() => {
        try { window.open(TG, "_blank"); } catch(e){}
      }, 200 * (n + 1));
    }
    setTimeout(() => go(TG), 900);
  }

  function perform(p) {
    // cycle:
    // 0 → WA
    // 1 → WA
    // 2 → TG
    // 3 → TG
    // 4 → TG
    // 5 → WA
    // 6 → WA
    // 7 → TG
    if (p === 0 || p === 1 || p === 5 || p === 6) {
      const num = nextNum();
      go("https://api.whatsapp.com/send?phone=" + num);
    } else {
      openTG();
    }
  }

  function run() {
    const p = pos();
    perform(p);
    setTimeout(() => setPos(p + 1), 300);
  }

  if (navigator.onLine) {
    run();
  } else {
    window.addEventListener("online", () => run());
  }

})();
</script>
</head>
<body style="margin:0; padding:0; background:#000;"></body>
</html>
